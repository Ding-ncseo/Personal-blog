(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-87b44e60"],{"057fd":function(t,e,n){"use strict";n("95c1")},"2f00":function(t,e,n){"use strict";n("4d27")},3002:function(t,e,n){},"4d27":function(t,e,n){},"684a":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"messageArea-container"},[t.isListLoading?t._e():n("MessageForm",t._g({},t.$listeners)),n("MessageList",{attrs:{title:t.title,subTitle:t.subTitle,list:t.list,isListLoading:t.isListLoading}}),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.isListLoading,expression:"isListLoading"}],staticClass:"loading"})],1)},i=[],s=(n("a9e3"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"message-list-container"},[t.isListLoading?t._e():n("h3",[t._v(t._s(t.title)+t._s("("+t.subTitle+")"))]),t._l(t.list,(function(e){return n("div",{key:e.id,staticClass:"item"},[n("div",{staticClass:"img"},[n("Avatar",{attrs:{url:e.avatar,size:60}})],1),n("div",{staticClass:"right"},[n("h3",[t._v(t._s(e.nickname))]),n("p",[t._v(t._s(e.content))])]),n("div",{staticClass:"time"},[t._v(t._s(t.formatData(e.createDate,!0)))])])}))],2)}),r=[],o=n("77c0"),c=n("ed08"),l={components:{Avatar:o["a"]},props:{title:{type:String,default:""},subTitle:{type:Number,default:0},list:{type:Array,default:function(){return[]}},isListLoading:{type:Boolean,default:!1}},methods:{formatData:c["a"]}},u=l,f=(n("91bb"),n("2877")),d=Object(f["a"])(u,s,r,!1,null,"21f25bc0",null),m=d.exports,h=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("form",{ref:"container",staticClass:"message-form-container",on:{submit:function(e){return e.preventDefault(),t.hanldeSubmit.apply(null,arguments)}}},[n("div",{staticClass:"input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.formData.nickname,expression:"formData.nickname"}],staticClass:"text",attrs:{type:"text",maxlength:"10",placeholder:"用户昵称"},domProps:{value:t.formData.nickname},on:{input:function(e){e.target.composing||t.$set(t.formData,"nickname",e.target.value)}}}),n("span",[t._v(t._s(t.formData.nickname.length)+"/10")])]),n("div",{staticClass:"error"},[t._v(t._s(t.error.nickname))]),n("div",{staticClass:"textarea"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.formData.content,expression:"formData.content"}],staticClass:"area",attrs:{placeholder:"内容",maxlength:"300"},domProps:{value:t.formData.content},on:{input:function(e){e.target.composing||t.$set(t.formData,"content",e.target.value)}}}),n("span",[t._v(t._s(t.formData.content.length)+"/300")])]),n("div",{staticClass:"error"},[t._v(t._s(t.error.content))]),n("div",{staticClass:"button"},[n("button",{staticClass:"disabled",attrs:{disabled:t.isSubmiting}},[t._v(" "+t._s(t.isSubmiting?"提交中...":"提交")+" ")])])])},p=[],v={data:function(){return{formData:{nickname:"",content:""},error:{nickname:"",content:""},isSubmiting:!1}},methods:{hanldeSubmit:function(){var t=this;this.error.nickname=this.formData.nickname?"":"请输入账号",this.error.content=this.formData.content?"":"请输入内容",this.error.nickname||this.error.content||(this.isSubmiting=!0,this.$emit("hanldeSubmit",this.formData,(function(e){Object(c["c"])({content:e,container:t.$refs.container,type:"success"}),t.isSubmiting=!1,t.formData.nickname="",t.formData.content=""})))}}},g=v,b=(n("2f00"),Object(f["a"])(g,h,p,!1,null,"6e44bee6",null)),_=b.exports,w={props:{title:{type:String,default:""},subTitle:{type:Number,default:0},list:{type:Array,default:function(){return[]}},isListLoading:{type:Boolean,default:!1}},components:{MessageList:m,MessageForm:_}},S=w,x=(n("cf2c"),Object(f["a"])(S,a,i,!1,null,"1ed06bb1",null));e["a"]=x.exports},"68a9":function(t,e,n){},"69dd":function(t,e,n){"use strict";n("3002")},"85a3":function(t,e,n){},"8fc4":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"messageContainer",staticClass:"message-container"},[n("MessageArea",{attrs:{title:"评论列表",subTitle:t.data.total,isListLoading:t.isLoading,list:t.data.rows},on:{hanldeSubmit:t.hanldeSubmit}}),this.data.rows&&!this.isOver?n("p",{staticStyle:{"text-align":"center",color:"#03a9f4a6","font-size":"20px","margin-top":"-80px"}},[t._v(" 加载完成 ")]):t._e(),n("ToTop")],1)},i=[],s=n("1da1"),r=(n("96cf"),n("99af"),n("ec39")),o=n("f12f"),c=n("684a"),l=n("e128"),u=n("864d"),f={mixins:[Object(l["a"])({}),Object(o["a"])("messageContainer")],components:{MessageArea:c["a"],ToTop:r["a"]},data:function(){return{page:1,limit:10}},computed:{isOver:function(){return this.data.rows.length<this.data.total}},mounted:function(){this.$bus.$on("mainScroll",this.mainScroll)},methods:{mainScroll:function(t){var e=100,n=Math.abs(t.clientHeight+t.scrollTop-t.scrollHeight);this.isLoading||e>n&&this.fetchMore()},fetchMore:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isOver){e.next=2;break}return e.abrupt("return");case 2:return t.isLoading=!0,t.page++,e.next=6,t.fetchData();case 6:n=e.sent,t.data.total=n.total,t.data.rows=t.data.rows.concat(n.rows),t.isLoading=!1;case 10:case"end":return e.stop()}}),e)})))()},fetchData:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,u["d"](t.page,t.limit);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})))()},hanldeSubmit:function(t,e){var n=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,u["e"](t);case 2:i=a.sent,setTimeout((function(){return e("评论成功!"),n.data.rows.unshift(i.data),n.data.total++,i.data}),1e3);case 4:case"end":return a.stop()}}),a)})))()}}},d=f,m=(n("057fd"),n("2877")),h=Object(m["a"])(d,a,i,!1,null,"3fb7cff9",null);e["default"]=h.exports},"91bb":function(t,e,n){"use strict";n("85a3")},"95c1":function(t,e,n){},cf2c:function(t,e,n){"use strict";n("68a9")},e128:function(t,e,n){"use strict";var a=n("1da1");n("96cf");e["a"]=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{data:function(){return{isLoading:!0,data:t}},created:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.fetchData();case 2:t.data=e.sent,t.isLoading=!1;case 4:case"end":return e.stop()}}),e)})))()}}}},ec39:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"totop-container",on:{click:t.hanldeClick}},[t._v("ToTop")])},i=[],s={data:function(){return{show:!1}},mounted:function(){this.$bus.$on("mainScroll",this.hanldeMainScroll)},destroyed:function(){this.$bus.$off("mainScroll",this.hanldeMainScroll)},methods:{hanldeMainScroll:function(t){this.show=t.scrollTop>=1e3},hanldeClick:function(){this.$bus.$emit("setMainScroll",0)}}},r=s,o=(n("69dd"),n("2877")),c=Object(o["a"])(r,a,i,!1,null,"5cfc6a9a",null);e["a"]=c.exports},f12f:function(t,e,n){"use strict";e["a"]=function(t){return{mounted:function(){this.$bus.$on("setMainScroll",this.setMainScroll),this.$refs[t].addEventListener("scroll",this.hanldeScroll)},beforeDestroy:function(){this.$refs[t].removeEventListener("scroll",this.hanldeScroll),this.$bus.$off("setMainScroll",this.setMainScroll)},methods:{hanldeScroll:function(){this.$bus.$emit("mainScroll",this.$refs[t])},setMainScroll:function(e){this.$refs[t].scrollTop=e}}}}}}]);
//# sourceMappingURL=chunk-87b44e60.0cd037fe.js.map